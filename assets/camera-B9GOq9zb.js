import{r as A,y as T,a as S,p as e,w as W}from"./chunk-B7RQU5TL-xj-QjgGV.js";import{u as z}from"./CameraSettingsContext-BDn7_6_x.js";import{C as F}from"./CameraSettings-DIau3yjd.js";var O={exports:{}},q=O.exports,R;function L(){return R||(R=1,(function(U,I){(function(w,v){U.exports=v(A())})(q,function(C){return(function(w){var v={};function m(s){if(v[s])return v[s].exports;var d=v[s]={i:s,l:!1,exports:{}};return w[s].call(d.exports,d,d.exports,m),d.l=!0,d.exports}return m.m=w,m.c=v,m.d=function(s,d,f){m.o(s,d)||Object.defineProperty(s,d,{enumerable:!0,get:f})},m.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},m.t=function(s,d){if(d&1&&(s=m(s)),d&8||d&4&&typeof s=="object"&&s&&s.__esModule)return s;var f=Object.create(null);if(m.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:s}),d&2&&typeof s!="string")for(var N in s)m.d(f,N,(function(h){return s[h]}).bind(null,N));return f},m.n=function(s){var d=s&&s.__esModule?function(){return s.default}:function(){return s};return m.d(d,"a",d),d},m.o=function(s,d){return Object.prototype.hasOwnProperty.call(s,d)},m.p="",m(m.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(w,v,m){m.r(v);var s=m("react"),d=(function(){var o=function(n,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},o(n,t)};return function(n,t){o(n,t);function r(){this.constructor=n}n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),f=function(){return f=Object.assign||function(o){for(var n,t=1,r=arguments.length;t<r;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},f.apply(this,arguments)},N=function(o,n){var t={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&n.indexOf(r)<0&&(t[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(o);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(o,r[i])&&(t[r[i]]=o[r[i]]);return t};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(n){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(r,i){t.call(navigator,n,r,i)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function h(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var P=(function(o){d(n,o);function n(t){var r=o.call(this,t)||this;return r.canvas=null,r.ctx=null,r.requestUserMediaId=0,r.unmounted=!1,r.state={hasUserMedia:!1},r}return n.prototype.componentDidMount=function(){var t=this,r=t.state,i=t.props;if(this.unmounted=!1,!h()){i.onUserMediaError("getUserMedia not supported");return}r.hasUserMedia||this.requestUserMedia(),i.children&&typeof i.children!="function"&&console.warn("children must be a function")},n.prototype.componentDidUpdate=function(t){var r=this.props;if(!h()){r.onUserMediaError("getUserMedia not supported");return}var i=JSON.stringify(t.audioConstraints)!==JSON.stringify(r.audioConstraints),a=JSON.stringify(t.videoConstraints)!==JSON.stringify(r.videoConstraints),x=t.minScreenshotWidth!==r.minScreenshotWidth,u=t.minScreenshotHeight!==r.minScreenshotHeight;(a||x||u)&&(this.canvas=null,this.ctx=null),(i||a)&&(this.stopAndCleanup(),this.requestUserMedia())},n.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},n.stopMediaStream=function(t){t&&(t.getVideoTracks&&t.getAudioTracks?(t.getVideoTracks().map(function(r){t.removeTrack(r),r.stop()}),t.getAudioTracks().map(function(r){t.removeTrack(r),r.stop()})):t.stop())},n.prototype.stopAndCleanup=function(){var t=this.state;t.hasUserMedia&&(n.stopMediaStream(this.stream),t.src&&window.URL.revokeObjectURL(t.src))},n.prototype.getScreenshot=function(t){var r=this,i=r.state,a=r.props;if(!i.hasUserMedia)return null;var x=this.getCanvas(t);return x&&x.toDataURL(a.screenshotFormat,a.screenshotQuality)},n.prototype.getCanvas=function(t){var r=this,i=r.state,a=r.props;if(!this.video||!i.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,u=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var l=x/u;x=a.minScreenshotWidth||this.video.clientWidth,u=x/l,a.minScreenshotHeight&&u<a.minScreenshotHeight&&(u=a.minScreenshotHeight,x=u*l)}this.canvas=document.createElement("canvas"),this.canvas.width=(t==null?void 0:t.width)||x,this.canvas.height=(t==null?void 0:t.height)||u,this.ctx=this.canvas.getContext("2d")}var y=this,g=y.ctx,c=y.canvas;return g&&c&&(c.width=(t==null?void 0:t.width)||c.width,c.height=(t==null?void 0:t.height)||c.height,a.mirrored&&(g.translate(c.width,0),g.scale(-1,1)),g.imageSmoothingEnabled=a.imageSmoothing,g.drawImage(this.video,0,0,(t==null?void 0:t.width)||c.width,(t==null?void 0:t.height)||c.height),a.mirrored&&(g.scale(-1,1),g.translate(-c.width,0))),c},n.prototype.requestUserMedia=function(){var t=this,r=this.props,i=function(u,l){var y={video:typeof l<"u"?l:!0};r.audio&&(y.audio=typeof u<"u"?u:!0),t.requestUserMediaId++;var g=t.requestUserMediaId;navigator.mediaDevices.getUserMedia(y).then(function(c){t.unmounted||g!==t.requestUserMediaId?n.stopMediaStream(c):t.handleUserMedia(null,c)}).catch(function(c){t.handleUserMedia(c)})};if("mediaDevices"in navigator)i(r.audioConstraints,r.videoConstraints);else{var a=function(u){return{optional:[{sourceId:u}]}},x=function(u){var l=u.deviceId;return typeof l=="string"?l:Array.isArray(l)&&l.length>0?l[0]:typeof l=="object"&&l.ideal?l.ideal:null};MediaStreamTrack.getSources(function(u){var l=null,y=null;u.forEach(function(j){j.kind==="audio"?l=j.id:j.kind==="video"&&(y=j.id)});var g=x(r.audioConstraints);g&&(l=g);var c=x(r.videoConstraints);c&&(y=c),i(a(l),a(y))})}},n.prototype.handleUserMedia=function(t,r){var i=this.props;if(t||!r){this.setState({hasUserMedia:!1}),i.onUserMediaError(t);return}this.stream=r;try{this.video&&(this.video.srcObject=r),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(r)})}i.onUserMedia(r)},n.prototype.render=function(){var t=this,r=this,i=r.state,a=r.props,x=a.audio;a.forceScreenshotSourceSize;var u=a.disablePictureInPicture;a.onUserMedia,a.onUserMediaError,a.screenshotFormat,a.screenshotQuality,a.minScreenshotWidth,a.minScreenshotHeight,a.audioConstraints,a.videoConstraints,a.imageSmoothing;var l=a.mirrored,y=a.style,g=y===void 0?{}:y,c=a.children,j=N(a,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),b=l?f(f({},g),{transform:(g.transform||"")+" scaleX(-1)"}):g,p={getScreenshot:this.getScreenshot.bind(this)};return s.createElement(s.Fragment,null,s.createElement("video",f({autoPlay:!0,disablePictureInPicture:u,src:i.src,muted:!x,playsInline:!0,ref:function(k){t.video=k},style:b},j)),c&&c(p))},n.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},n})(s.Component);v.default=P}),react:(function(w,v){w.exports=C})}).default})})(O)),O.exports}var H=L();const B=T(H);function D({className:U=""}){var i,a,x,u,l,y,g,c,j;const I=S.useRef(null),[C,w]=S.useState(null),[v,m]=S.useState(null),[s,d]=S.useState(!1),[f,N]=S.useState(null),[h,P]=S.useState({capabilities:null,settings:null,constraints:null}),{settings:o}=z(),n={width:o.videoConstraints.width,height:o.videoConstraints.height,facingMode:o.videoConstraints.facingMode},t=S.useCallback(async()=>{try{const b=await navigator.mediaDevices.getUserMedia({video:n}),p=b.getVideoTracks()[0];if(p){const k=p.getCapabilities(),E=p.getSettings(),_=p.getConstraints();P({capabilities:k,settings:E,constraints:_}),b.getTracks().forEach(M=>M.stop())}}catch(b){console.error("Error getting camera info:",b)}},[n]),r=S.useCallback(async()=>{if(I.current){d(!0),N(null);try{await new Promise(p=>setTimeout(p,o.focusDelay*1e3));const b=I.current.getScreenshot({width:o.videoConstraints.width,height:o.videoConstraints.height});if(b){w(b);const p=new Image;p.onload=()=>{const k=document.createElement("canvas"),E=k.getContext("2d");if(E){k.width=p.width,k.height=p.height,E.drawImage(p,0,0);const _=k.toDataURL(o.screenshotFormat,o.screenshotQuality),M=Math.round((_.length-22)*3/4);m({format:o.screenshotFormat,dimensions:`${p.width} x ${p.height}`,size:M>1024?`${(M/1024).toFixed(1)} KB`:`${M} bytes`})}},p.src=b}}catch(b){N("Error al capturar la imagen"),console.error("Error capturing image:",b)}finally{d(!1)}}},[o]);return e.jsxs("div",{className:`space-y-6 ${U}`,children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Información de la Cámara"}),e.jsx("button",{onClick:t,className:"px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors duration-200",children:"Actualizar Info"})]}),h.capabilities?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Resoluciones Soportadas"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Ancho:"}),e.jsxs("span",{className:"ml-2 text-gray-900 dark:text-white",children:[(i=h.capabilities.width)==null?void 0:i.min," - ",(a=h.capabilities.width)==null?void 0:a.max," px"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Alto:"}),e.jsxs("span",{className:"ml-2 text-gray-900 dark:text-white",children:[(x=h.capabilities.height)==null?void 0:x.min," - ",(u=h.capabilities.height)==null?void 0:u.max," px"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Configuración Actual"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Resolución:"}),e.jsxs("span",{className:"ml-2 text-gray-900 dark:text-white",children:[(l=h.settings)==null?void 0:l.width," x ",(y=h.settings)==null?void 0:y.height]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Cámara:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:((g=h.settings)==null?void 0:g.facingMode)==="environment"?"Trasera":"Frontal"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"FPS:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:((c=h.settings)==null?void 0:c.frameRate)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Dispositivo:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:(j=h.settings)!=null&&j.deviceId?"ID: "+h.settings.deviceId.substring(0,8)+"...":"N/A"})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Capacidades Adicionales"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Zoom:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:h.capabilities.zoom?"Soportado":"No soportado"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Enfoque:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:h.capabilities.focusMode?"Soportado":"No soportado"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Balance de Blancos:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:h.capabilities.whiteBalanceMode?"Soportado":"No soportado"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Exposición:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:h.capabilities.exposureMode?"Soportado":"No soportado"})]})]})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"})})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:'Haz clic en "Actualizar Info" para obtener información de la cámara'}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors duration-200",children:"Obtener Información"})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsx(F,{showTitle:!0,showResetButton:!0})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4 text-gray-900 dark:text-white",children:"Vista Previa"}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 rounded-md",children:f}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{ref:I,audio:!1,videoConstraints:n,className:"w-full h-auto rounded-lg",style:{maxHeight:"60vh"},onUserMediaError:b=>{N("Error al acceder a la cámara. Verifica los permisos."),console.error("Webcam error:",b)}}),s&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2"}),e.jsx("p",{children:"Enfocando..."})]})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors duration-200",children:s?"Enfocando...":"Tomar Foto"})})]}),C&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-4 text-gray-900 dark:text-white",children:"Foto Capturada"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("img",{src:C,alt:"Captured",className:"w-full h-auto rounded-lg",style:{maxHeight:"60vh"}}),v&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"Información de la Imagen"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Formato:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:v.format})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Dimensiones:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:v.dimensions})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Tamaño:"}),e.jsx("span",{className:"ml-2 text-gray-900 dark:text-white",children:v.size})]})]})]})]})]})]})}function Q({}){return[{title:"Cámara - React Webcam Explorer"},{name:"description",content:"Página de prueba para funcionalidades de react-webcam con configuración avanzada"}]}const J=W(function(){return e.jsxs("div",{className:"min-h-screen pb-20",style:{backgroundColor:"var(--color-background)"},children:[e.jsxs("div",{className:"shadow-sm border-b px-4 py-4",style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)"},children:[e.jsx("h1",{className:"text-xl font-semibold",style:{color:"var(--color-text-primary)"},children:"📷 Prueba de Cámara"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--color-text-secondary)"},children:"Configuración avanzada para captura de fotos con react-webcam"})]}),e.jsx("div",{className:"p-4",children:e.jsx(D,{})}),e.jsxs("div",{className:"px-4 mt-6",children:[e.jsx("h2",{className:"text-lg font-medium mb-3",style:{color:"var(--color-text-primary)"},children:"Instrucciones de Uso"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full mt-2",style:{backgroundColor:"var(--color-accent)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Configura los parámetros de la cámara según tus necesidades"})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full mt-2",style:{backgroundColor:"var(--color-accent)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Ajusta el delay de enfoque para obtener mejores resultados"})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full mt-2",style:{backgroundColor:"var(--color-accent)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:"Ideal para capturar pantallas de notebook con celular para OCR"})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full mt-2",style:{backgroundColor:"var(--color-accent)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:'Desactiva "Image Smoothing" para mantener bordes más definidos'})]})]})]})]})});export{J as default,Q as meta};
